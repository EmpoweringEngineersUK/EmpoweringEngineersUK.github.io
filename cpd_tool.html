<!DOCTYPE html>
<html lang="en-GB">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PG4ZJ7W444"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-PG4ZJ7W444');
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPD Smart-Planner [v5.1] | EmpoweringEngineers.uk</title>
    <link rel="icon" type="image/jpeg" href="Favicon.jpg">
    
    <meta property="og:title" content="CPD Gap Analyzer | Empowering Engineers UK">
    <meta property="og:description" content="Generate a discipline-specific 70/20/10 learning plan for CEng, IEng, or EngTech. Now supporting Structural and Building Services.">
    <meta property="og:image" content="https://www.empoweringengineers.uk/EE_Logo_rect_Solid.png">
    <meta property="og:url" content="https://www.empoweringengineers.uk/cpd_tool.html">
    <meta property="og:type" content="website">

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7071036534151105" crossorigin="anonymous"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@700&family=Roboto:wght@400;500;700&family=Courier+Prime&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="layout.css">
    
    <script src="cpd.js"></script>
    
    <style>
        /* PAGE SPECIFIC LAYOUT */
        
        /* Grid for Context Selectors */
        .context-bar {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            background: rgba(255,255,255,0.02);
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 25px;
        }

        .profile-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 30px; 
            margin-bottom: 30px; 
        }

        /* Slider Rows */
        .slider-row { 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            margin-bottom: 12px; 
            padding: 8px 10px; 
            background: rgba(255,255,255,0.02); 
            border-radius: 4px; 
            border: 1px solid transparent;
            transition: 0.2s;
        }
        .slider-row:hover { border-color: var(--border-color); }

        .slider-label { 
            width: 50%; 
            font-family: 'Courier Prime', monospace; 
            font-size: 0.85rem; 
            color: var(--cloud-white);
        }
        
        .slider-input { 
            width: 50%; 
            accent-color: var(--terminal-green); 
            cursor: pointer; 
        }

        /* Results Box Animation */
        .results-box { display: none; margin-top: 20px; animation: fadeIn 0.5s ease-in; }

        /* CPD Plan Item Cards */
        .plan-item { 
            background: var(--dark-card); 
            padding: 20px; 
            border-left: 4px solid var(--terminal-green); 
            margin-bottom: 15px; 
            border-radius: 0 4px 4px 0; 
            border: 1px solid var(--border-color);
            border-left-width: 4px; 
        }
        .plan-header { 
            display: flex; 
            justify-content: space-between; 
            border-bottom: 1px solid rgba(255,255,255,0.1); 
            padding-bottom: 10px; 
            margin-bottom: 10px; 
        }
        .plan-title { font-weight: bold; color: var(--terminal-green); font-size: 1.1rem; }
        .plan-score { color: var(--burnt-orange); font-family: 'Courier Prime', monospace; }
        
        /* Plan Details */
        .plan-70 { color: var(--cloud-white); display: block; margin-top: 10px; font-size: 0.95rem; }
        .plan-20 { color: var(--slate-grey); display: block; margin-top: 8px; font-size: 0.95rem; }
        .plan-10 { color: var(--slate-grey); display: block; margin-top: 8px; font-size: 0.95rem; font-style: italic; }

        .tag { 
            display: inline-block; 
            background: rgba(0,255,153,0.1); 
            border: 1px solid var(--terminal-green); 
            color: var(--terminal-green); 
            padding: 2px 6px; 
            border-radius: 3px; 
            font-size: 0.7rem; 
            margin-left: 10px; 
            vertical-align: middle; 
            font-family: 'Courier Prime', monospace;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @media (max-width: 700px) { .profile-grid, .context-bar { grid-template-columns: 1fr; } }
    </style>
</head>
<body onload="initApp()">
	<script defer src="header_nav.js"></script>
    <div class="sticky-container">
        <a href="index.html">
            <img src="EE_Logo_rect_Trans.png" alt="Empowering Engineers UK" class="site-brand-img">
        </a>
        <nav>
            <a href="career_tool.html">Career</a>
            <a href="cpd_tool.html" class="active">CPD</a>
			<a href="raci_tool.html">RACI</a>
            <a href="STAR_engine.html">STAR-Gen</a>
            <a href="ethics_tool.html">Ethics</a>
            <a href="feedback_tool.html">Coach</a>
            <a href="glossary_tool.html">Decoder</a>
            <a href="reference_tool.html">Library</a>
            <a href="report_tool.html">Report</a>
            <a href="dap_tool.html">DAP</a>
            <a href="interview_tool.html">Interview</a>
			<a href="guide.html">Manual</a>
        </nav>
    </div>

    <div class="container">
        <div class="card">
            <h2>CPD Smart-Planner [v5.1]</h2>
            <p style="color:var(--slate-grey); margin-bottom:20px; font-size:0.9rem;">
                Generate a discipline-specific <strong>70/20/10 Learning Plan</strong> tailored to your registration level (UK-SPEC).
            </p>

            <div class="context-bar">
                <div>
                    <label>Target Registration</label>
                    <select id="targetLevel" onchange="generatePlan()">
                        <option value="CEng">CEng (Chartered)</option>
                        <option value="IEng">IEng (Incorporated)</option>
                        <option value="EngTech">EngTech (Technician)</option>
                    </select>
                </div>
                <div>
                    <label>Discipline</label>
                    <select id="discipline" onchange="generatePlan()">
                        <option value="General">General Engineering</option>
                        <option value="Mechanical">Mechanical / Piping</option>
                        <option value="Electrical">Electrical / C&I</option>
                        <option value="Civil">Civil Engineering</option>
                        <option value="Structural">Structural Engineering</option>
                        <option value="BuildingServices">Building Services (MEP)</option>
                        <option value="Software">Software / Systems</option>
                    </select>
                </div>
            </div>

            <div class="profile-grid">
                <div>
                    <h3>A: Knowledge</h3>
                    <div class="slider-row"><span class="slider-label">A1: Maintain/Extend</span><input type="range" min="0" max="100" value="50" class="slider-input" id="a1" oninput="saveData()"></div>
                    <div class="slider-row"><span class="slider-label">A2: Application</span><input type="range" min="0" max="100" value="50" class="slider-input" id="a2" oninput="saveData()"></div>

                    <h3 style="margin-top:20px;">B: Design & Solutions</h3>
                    <div class="slider-row"><span class="slider-label">B1: Identify Problems</span><input type="range" min="0" max="100" value="50" class="slider-input" id="b1" oninput="saveData()"></div>
                    <div class="slider-row"><span class="slider-label">B2: Design Solutions</span><input type="range" min="0" max="100" value="50" class="slider-input" id="b2" oninput="saveData()"></div>
                    <div class="slider-row"><span class="slider-label">B3: Implementation</span><input type="range" min="0" max="100" value="50" class="slider-input" id="b3" oninput="saveData()"></div>

                    <h3 style="margin-top:20px;">C: Leadership</h3>
                    <div class="slider-row"><span class="slider-label">C1: Planning</span><input type="range" min="0" max="100" value="50" class="slider-input" id="c1" oninput="saveData()"></div>
                    <div class="slider-row"><span class="slider-label">C2: Resources/Budget</span><input type="range" min="0" max="100" value="50" class="slider-input" id="c2" oninput="saveData()"></div>
                    <div class="slider-row"><span class="slider-label">C3: Teams/Staff</span><input type="range" min="0" max="100" value="50" class="slider-input" id="c3" oninput="saveData()"></div>
                    <div class="slider-row"><span class="slider-label">C4: Quality</span><input type="range" min="0" max="100" value="50" class="slider-input" id="c4" oninput="saveData()"></div>
                </div>

                <div>
                    <h3>D: Communication</h3>
                    <div class="slider-row"><span class="slider-label">D1: English Language</span><input type="range" min="0" max="100" value="50" class="slider-input" id="d1" oninput="saveData()"></div>
                    <div class="slider-row"><span class="slider-label">D2: Presentation</span><input type="range" min="0" max="100" value="50" class="slider-input" id="d2" oninput="saveData()"></div>
                    <div class="slider-row"><span class="slider-label">D3: Social Skills</span><input type="range" min="0" max="100" value="50" class="slider-input" id="d3" oninput="saveData()"></div>

                    <h3 style="margin-top:20px;">E: Commitment</h3>
                    <div class="slider-row"><span class="slider-label">E1: Codes of Conduct</span><input type="range" min="0" max="100" value="50" class="slider-input" id="e1" oninput="saveData()"></div>
                    <div class="slider-row"><span class="slider-label">E2: Safety & Risk</span><input type="range" min="0" max="100" value="50" class="slider-input" id="e2" oninput="saveData()"></div>
                    <div class="slider-row"><span class="slider-label">E3: Sustainability</span><input type="range" min="0" max="100" value="50" class="slider-input" id="e3" oninput="saveData()"></div>
                    <div class="slider-row"><span class="slider-label">E4: CPD Records</span><input type="range" min="0" max="100" value="50" class="slider-input" id="e4" oninput="saveData()"></div>
                    <div class="slider-row"><span class="slider-label">E5: Ethics</span><input type="range" min="0" max="100" value="50" class="slider-input" id="e5" oninput="saveData()"></div>
                </div>
            </div>

            <button class="action-btn" onclick="generatePlan()">Generate Smart-Plan</button>
            <button class="action-btn action-btn-ghost" onclick="resetForm()" style="margin-top:10px;">Reset Scores</button>

            <div id="resultsArea" class="results-box"></div>
        </div>
    </div>

    <footer>
        <p>&copy; <script>document.write(new Date().getFullYear())</script> Empowering Engineers UK. All rights reserved.</p>
        <p>
            <a href="about.html">About Us</a> | 
            <a href="contact.html">Contact Us</a> | 
            <a href="terms.html">Terms of Use</a> | 
            <a href="privacy.html">Privacy Policy</a>
        </p>
    </footer>

    <script>
        const ids = ["a1", "a2", "b1", "b2", "b3", "c1", "c2", "c3", "c4", "d1", "d2", "d3", "e1", "e2", "e3", "e4", "e5"];

        // --- LOOKUP FUNCTION (Data is in cpd.js) ---
        // If cpd.js fails to load, this prevents the page from crashing
        function getAdviceSafely(id, level, disc) {
            if (typeof cpdDb === 'undefined') {
                return "Database not loaded. Please refresh the page.";
            }
            if (cpdDb[id] && cpdDb[id][level]) {
                if (cpdDb[id][level][disc]) return cpdDb[id][level][disc];
                if (cpdDb[id][level]["General"]) return cpdDb[id][level]["General"];
            }
            return "Undertake specific training or seek mentorship in this area.";
        }

        // --- APP LOGIC ---
        function initApp() {
            loadSavedData();
        }

        function saveData() {
            ids.forEach(id => {
                localStorage.setItem('cpd_v5_' + id, document.getElementById(id).value);
            });
            localStorage.setItem('cpd_level', document.getElementById('targetLevel').value);
            localStorage.setItem('cpd_disc', document.getElementById('discipline').value);
        }

        function loadSavedData() {
            ids.forEach(id => {
                const saved = localStorage.getItem('cpd_v5_' + id);
                if (saved) document.getElementById(id).value = saved;
            });
            if(localStorage.getItem('cpd_level')) document.getElementById('targetLevel').value = localStorage.getItem('cpd_level');
            if(localStorage.getItem('cpd_disc')) document.getElementById('discipline').value = localStorage.getItem('cpd_disc');
        }

        function generatePlan() {
            const container = document.getElementById('resultsArea');
            const level = document.getElementById('targetLevel').value;
            const disc = document.getElementById('discipline').value;
            
            container.innerHTML = "";
            container.style.display = 'block';
            let gapFound = false;

            ids.forEach(id => {
                const val = document.getElementById(id).value;
                if(val < 70) {
                    gapFound = true;
                    // Call the external DB safely
                    const specificAdvice = getAdviceSafely(id, level, disc);
                    
                    const html = `
                        <div class="plan-item">
                            <div class="plan-header">
                                <span class="plan-title">Gap ${id.toUpperCase()} <span class="tag">${level} | ${disc}</span></span>
                                <span class="plan-score">Confidence: ${val}%</span>
                            </div>
                            <span class="plan-70"><strong>70% (On-the-Job):</strong> ${specificAdvice}</span>
                            <span class="plan-20"><strong>20% (Social/Peer):</strong> Discuss this specific competency with a ${level} mentor.</span>
                            <span class="plan-10"><strong>10% (Formal Training):</strong> Read the UK-SPEC section on ${id.toUpperCase()} closely.</span>
                        </div>
                    `;
                    container.innerHTML += html;
                }
            });

            if(!gapFound) {
                container.innerHTML = `<div class="plan-item" style="border-left-color:var(--terminal-green)"><div class="plan-header"><span class="plan-title">Ready for Assessment?</span></div><p style="color:var(--cloud-white);">Your self-assessment indicates strong competence (>70%) across all areas for <strong>${level} (${disc})</strong>. Consider booking your Professional Review Interview.</p></div>`;
            }
            
            container.scrollIntoView({behavior: "smooth"});
        }

        function resetForm() {
            if(confirm("Reset all sliders?")) {
                ids.forEach(id => {
                    document.getElementById(id).value = 50;
                    localStorage.removeItem('cpd_v5_' + id);
                });
                document.getElementById('resultsArea').style.display = 'none';
            }
        }
    </script>
	
	<script src="footer_feedback.js"></script>
	
</body>
</html>